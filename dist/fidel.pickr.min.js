
/*!
 * pickr - A javascript datepicker
 * v0.1.0
 * https://github.com/firstandthird/pickr
 * copyright First + Third 2013
 * MIT License
*/
!function(a){a.declare("pickr",{defaults:{hideDelay:150,displayMonths:1,template:"##template##",currentMonth:new Date,dayLabels:["Su","Mo","Tu","We","Th","Fr","Sa"],dateFormat:"%Y-%m-%d",allowPastDays:!0},init:function(){this.el.addClass("pickr"),this.pickrContainer=a("<div></div>").addClass("pickr-container"),this.el.after(this.pickrContainer),this.focus=!1,this.el.data("pickr-format")&&(this.dateFormat=this.el.data("pickr-format")),this.bindEvents()},bindEvents:function(){this.el.on("focus",this.proxy(this.showModal)),this.el.on("blur",this.proxy(this.hideModal)),this.pickrContainer.on("click",this.proxy(this.containerClicked)),this.pickrContainer.on("click","*",this.proxy(this.containerClicked))},update:function(){var a,b,c=[];for(a=0;a<this.displayMonths;a++)b=new Date(this.currentMonth.getFullYear(),this.currentMonth.getMonth()+a,1),c.push({date:b,days:this.daysInMonth(b),start:this.monthStartIndex(b),end:this.monthEndIndex(b)});var d={timef:TimeFormat,months:c,dayLabels:this.dayLabels,today:new Date,allowPastDays:this.allowPastDays};this.render(d,this.pickrContainer)},showModal:function(){if(!this.focus){this.focus=!0;var a=this.el.offset();this.pickrContainer.css({left:a.left,top:a.top+this.el.outerHeight()}),this.update()}},hideModal:function(a){a.preventDefault(),this.hideTimer=setTimeout(this.proxy(function(){this.pickrContainer.empty(),this.focus=!1}),this.hideDelay)},containerClicked:function(b){b.stopPropagation(),b.preventDefault(),clearTimeout(this.hideTimer),this.focus=!0,this.el.focus();var c=a(b.target);if(c.is(".pickr-day")&&!c.is(".pickr-past")){var d=c.text(),e=new Date(c.parents(".pickr-month").data("pickr-date"));e.setDate(d),this.selectDate(e)}c.is(".pickr-prev-month")&&this.prevMonth(),c.is(".pickr-next-month")&&this.nextMonth(),c.is(".pickr-month-title")&&this.today()},selectDate:function(a){this.el.val(TimeFormat(this.dateFormat,a)),this.el.blur()},daysInMonth:function(a){var b=new Date(a.getFullYear(),a.getMonth()+1,0);return b.getDate()},monthStartIndex:function(a){var b=new Date(a.getFullYear(),a.getMonth(),1);return b.getDay()},monthEndIndex:function(a){var b=new Date(a.getFullYear(),a.getMonth(),this.daysInMonth(a));return 6-b.getDay()},prevMonth:function(){this.currentMonth.setMonth(this.currentMonth.getMonth()-this.displayMonths),this.update()},nextMonth:function(){this.currentMonth.setMonth(this.currentMonth.getMonth()+this.displayMonths),this.update()},today:function(){this.currentMonth=new Date,this.update()}})}(jQuery);